{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst elements = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nlet currentPage = 1;\nelements.loadMoreBtn.style.display = 'none';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\niziToast.settings({\n  position: 'topRight',\n});\n\nelements.searchForm.addEventListener('submit', handlerFormSubmit);\nelements.loadMoreBtn.addEventListener('click', loadMoreImages);\n\nasync function loadMoreImages() {\n  currentPage += 1;\n  try {\n    const searchQuery = elements.searchForm.elements.searchQuery.value;\n    const data = await serviceImage(searchQuery, currentPage);\n\n    elements.gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n\n    if (currentPage === Math.ceil(data.totalHits / 40)) {\n      elements.loadMoreBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      elements.loadMoreBtn.style.display = 'block';\n      lightbox.refresh();\n    }\n  } catch (error) {\n    console.error('Error loading more images:', error);\n    iziToast.error({\n      message: 'Error fetching more images. Please try again.',\n    });\n  }\n}\n\nasync function handlerFormSubmit(evt) {\n  evt.preventDefault();\n  currentPage = 1;\n  elements.gallery.innerHTML = '';\n  elements.loadMoreBtn.style.display = 'none';\n  const searchQuery = evt.currentTarget.elements.searchQuery.value.trim();\n  if (!searchQuery) {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n    });\n\n    return;\n  }\n  try {\n    const data = await serviceImage(searchQuery);\n\n    if (data.hits.length === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n      });\n      elements.loadMoreBtn.style.display = 'none';\n      return;\n    }\n\n    elements.gallery.insertAdjacentHTML('afterbegin', createMarkup(data.hits));\n    lightbox.refresh();\n    elements.loadMoreBtn.style.display = 'block';\n    if (currentPage === Math.ceil(data.totalHits / 40)) {\n      elements.loadMoreBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    iziToast.error({\n      message: 'Error fetching images. Please try again.',\n    });\n  }\n}\n\nasync function serviceImage(q, page = 1) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '41114250-186ebd042d251d6e26d9d298e';\n\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 40,\n      },\n    });\n\n    if (response.data.hits.length === 0) {\n      return { hits: [], totalHits: 0 };\n    }\n    return response.data;\n  } catch (error) {\n    throw new Error(error.message || 'Error fetching images');\n  }\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <div class=\"photo-card\"><a class=\"img-link\" href=\"${largeImageURL}\">\n    <img class=\"photo-card-img\"src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" /></a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes ${likes}</b>\n        </p>\n            <p class=\"info-item\">\n        <b>Views ${views}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments ${comments}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads ${downloads}</b>\n        </p>\n    </div>\n</div>\n    `\n    )\n    .join('');\n}"],"names":["elements","currentPage","lightbox","SimpleLightbox","iziToast","handlerFormSubmit","loadMoreImages","searchQuery","data","serviceImage","createMarkup","error","evt","q","page","BASE_URL","API_KEY","response","axios","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}